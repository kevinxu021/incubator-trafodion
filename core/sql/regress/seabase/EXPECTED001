>>obey TEST001(setup);
>>create table t001t1(a int not null primary key, b int, c int default 10 not null)
+>   hbase_options (max_versions = '3');

--- SQL operation complete.
>>
>>create table t001t2 (name char(10) not null primary key,
+>                     "position" char(10)) hbase_options (max_versions = '4');

--- SQL operation complete.
>>
>>obey TEST001(dml);
>>select * from t001t1 {versions max};

--- 0 row(s) selected.
>>insert into t001t1 values (1,1,1);

--- 1 row(s) inserted.
>>select * from t001t1 {versions max};

A            B            C          
-----------  -----------  -----------

          1            1            1

--- 1 row(s) selected.
>>insert into t001t1(a) values (2);

--- 1 row(s) inserted.
>>select * from t001t1 {versions max};

A            B            C          
-----------  -----------  -----------

          1            1            1
          2            ?           10

--- 2 row(s) selected.
>>update t001t1 set b = 2;

--- 2 row(s) updated.
>>select * from t001t1 {versions 4};

A            B            C          
-----------  -----------  -----------

          1            2            1
          1            1            1
          2            2           10

--- 3 row(s) selected.
>>select * from t001t1 {versions max};

A            B            C          
-----------  -----------  -----------

          1            2            1
          1            1            1
          2            2           10

--- 3 row(s) selected.
>>
>>cqd traf_num_hbase_versions '-1';

--- SQL operation complete.
>>select * from t001t1;

A            B            C          
-----------  -----------  -----------

          1            2            1
          1            1            1
          2            2           10

--- 3 row(s) selected.
>>
>>cqd traf_num_hbase_versions reset;

--- SQL operation complete.
>>cqd hbase_timestamp_set '2000-01-02 10:10:10';

--- SQL operation complete.
>>insert into t001t2 values ('Jill', 'Manager');

--- 1 row(s) inserted.
>>cqd hbase_timestamp_set '2001-01-02 09:09:09';

--- SQL operation complete.
>>insert into t001t2 values ('Jack', 'Programmer');

--- 1 row(s) inserted.
>>cqd hbase_timestamp_set '2002-01-02 09:09:09';

--- SQL operation complete.
>>update t001t2 set "position" = 'Architect' where name = 'Jack';

--- 1 row(s) updated.
>>select * from t001t2;

NAME        position  
----------  ----------

Jack        Architect 
Jill        Manager   

--- 2 row(s) selected.
>>select * from t001t2 {versions max};

NAME        position  
----------  ----------

Jack        Architect 
Jack        Programmer
Jill        Manager   

--- 3 row(s) selected.
>>select name, "position", hbase_timestamp("position", localtime) from t001t2
+>  {versions max};

NAME        position    (EXPR)                 
----------  ----------  -----------------------

Jack        Architect   2002-01-02 09:09:09.000
Jack        Programmer  2001-01-02 09:09:09.000
Jill        Manager     2000-01-02 10:10:10.000

--- 3 row(s) selected.
>>select hbase_version("position"), hbase_timestamp("position", localtime),* 
+>        from t001t2 {timestamp as of '1999-09-10 17:54:16', versions max};

--- 0 row(s) selected.
>>select hbase_version("position"), hbase_timestamp("position", localtime),* 
+>        from t001t2 {timestamp as of '2000-09-10 17:54:16', versions max};

(EXPR)                (EXPR)                   NAME        position  
--------------------  -----------------------  ----------  ----------

                   1  2000-01-02 10:10:10.000  Jill        Manager   

--- 1 row(s) selected.
>>select hbase_version("position"), hbase_timestamp("position", localtime),* 
+>        from t001t2 {timestamp as of '2001-09-10 17:54:16', versions max};

(EXPR)                (EXPR)                   NAME        position  
--------------------  -----------------------  ----------  ----------

                   1  2001-01-02 09:09:09.000  Jack        Programmer
                   1  2000-01-02 10:10:10.000  Jill        Manager   

--- 2 row(s) selected.
>>select hbase_version("position"), hbase_timestamp("position", localtime),* 
+>        from t001t2 {timestamp as of '2015-09-10 17:54:16', versions max};

(EXPR)                (EXPR)                   NAME        position  
--------------------  -----------------------  ----------  ----------

                   1  2002-01-02 09:09:09.000  Jack        Architect 
                   2  2001-01-02 09:09:09.000  Jack        Programmer
                   1  2000-01-02 10:10:10.000  Jill        Manager   

--- 3 row(s) selected.
>>
>>log;
